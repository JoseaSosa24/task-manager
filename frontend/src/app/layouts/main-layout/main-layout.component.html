<div class="flex h-screen bg-gray-50 dark:bg-gray-900">
  <!-- Modern Sidebar -->
  <aside class="sidebar-modern w-64 flex-shrink-0 hidden md:flex flex-col transition-all duration-300"
         [class.w-16]="sidebarCollapsed">
    
    <!-- Sidebar Header -->
    <div class="flex items-center justify-between p-6 border-b border-gray-700/50">
      <div class="flex items-center space-x-3" [class.hidden]="sidebarCollapsed">
        <div class="w-10 h-10 bg-gradient-primary rounded-xl flex items-center justify-center shadow-glow">
          <i class="pi pi-check-circle text-white text-lg"></i>
        </div>
        <div>
          <h1 class="text-xl font-bold text-white">TaskFlow</h1>
          <p class="text-xs text-gray-400">Pro Dashboard</p>
        </div>
      </div>
      <button (click)="toggleSidebar()" 
              class="p-2 rounded-lg hover:bg-white/10 transition-colors text-gray-400 hover:text-white">
        <i class="pi pi-bars"></i>
      </button>
    </div>

    <!-- User Profile Section -->
    <div class="p-6 border-b border-gray-700/50" [class.hidden]="sidebarCollapsed" *ngIf="userProfile">
      <div class="flex items-center space-x-3">
        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
          <span class="text-white font-semibold text-lg">
            {{ getUserInitials() }}
          </span>
        </div>
        <div class="flex-1 min-w-0">
          <div class="font-semibold text-white truncate">{{ getFirstName() }}</div>
          <div class="text-sm text-gray-400 truncate">{{ getUserEmail() }}</div>
        </div>
      </div>
    </div>

    <!-- Navigation Menu -->
    <nav class="flex-1 px-4 py-6 space-y-2 overflow-y-auto">
      <!-- Dashboard -->
      <a routerLink="/dashboard" 
         routerLinkActive="active"
         class="sidebar-item group">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-th-large text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3" [class.hidden]="sidebarCollapsed">Dashboard</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity" [class.hidden]="sidebarCollapsed">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a>

      <!-- Tasks (Highlighted) -->
      <!-- <a routerLink="/tasks" 
         class="sidebar-item group bg-gradient-to-r from-red-500/20 to-pink-500/20 border border-red-500/30">
        <div class="w-10 h-10 rounded-xl bg-red-500/20 flex items-center justify-center group-hover:bg-red-500/30 transition-colors">
          <i class="pi pi-exclamation-triangle text-lg text-red-400"></i>
        </div>
        <span class="font-medium text-red-300 ml-3" [class.hidden]="sidebarCollapsed">Vital Tasks</span>
        <div class="ml-auto" [class.hidden]="sidebarCollapsed">
          <span class="px-2 py-1 bg-red-500 text-white text-xs rounded-full">{{ getTotalTasks() }}</span>
        </div>
      </a> -->

      <!-- My Tasks -->
      <a routerLink="/tasks" 
         routerLinkActive="active"
         class="sidebar-item group">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-check-circle text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3" [class.hidden]="sidebarCollapsed">Mis tareas</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity" [class.hidden]="sidebarCollapsed">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a>

      <!-- Categories -->
     <!--  <a href="#" class="sidebar-item group">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-tags text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3" [class.hidden]="sidebarCollapsed">Categories</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity" [class.hidden]="sidebarCollapsed">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a> -->

      <!-- Analytics -->
      <!-- <a href="#" class="sidebar-item group">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-chart-bar text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3" [class.hidden]="sidebarCollapsed">Analytics</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity" [class.hidden]="sidebarCollapsed">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a> -->

      <!-- Divider -->
      <div class="border-t border-gray-700/50 my-6"></div>

      <!-- Settings -->
      <a routerLink="/profile" 
         routerLinkActive="active"
         class="sidebar-item group">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-cog text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3" [class.hidden]="sidebarCollapsed">Configuración</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity" [class.hidden]="sidebarCollapsed">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a>

      <!-- Help -->
      <!-- <a href="#" class="sidebar-item group">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-question-circle text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3" [class.hidden]="sidebarCollapsed">Help</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity" [class.hidden]="sidebarCollapsed">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a> -->
    </nav>

    <!-- Logout Button -->
    <div class="p-4 border-t border-gray-700/50">
      <button (click)="logout()" 
              class="sidebar-item group w-full hover:bg-red-500/20 border border-transparent hover:border-red-500/30">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-red-500/20 transition-colors">
          <i class="pi pi-sign-out text-lg text-white group-hover:text-red-300"></i>
        </div>
        <span class="font-medium text-white group-hover:text-red-300 ml-3" [class.hidden]="sidebarCollapsed">Cerrar Sesión</span>
      </button>
    </div>
  </aside>

  <!-- Main Content Area -->
  <div class="flex-1 flex flex-col min-w-0">
    <!-- Top Navigation Bar -->
    <header class="glass-card-strong mx-6 mt-6 mb-4 sticky top-6 z-30">
      <div class="flex items-center justify-between p-4">
        <!-- Mobile Menu Button -->
        <button class="md:hidden p-2 rounded-lg hover:bg-white/10 transition-colors"
                (click)="toggleMobileMenu()">
          <i class="pi pi-bars text-xl text-gray-700 dark:text-gray-300"></i>
        </button>

        <!-- Search Bar -->
        <div class="flex-1 max-w-md mx-4">
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="pi pi-search text-gray-400"></i>
            </div>
            <input type="text" 
                   placeholder="Search tasks, projects..."
                   class="w-full pl-10 pr-4 py-2 bg-white/50 dark:bg-gray-800/50 border border-white/20 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent backdrop-blur-sm transition-all duration-200">
          </div>
        </div>

        <!-- Right Side Actions -->
        <div class="flex items-center space-x-3">
          <!-- Notifications -->
          <!-- <button class="relative p-2 rounded-xl hover:bg-white/10 transition-colors group">
            <i class="pi pi-bell text-xl text-gray-700 dark:text-gray-300 group-hover:text-blue-500"></i>
            <div class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center">
              <span class="text-xs text-white font-bold">3</span>
            </div>
          </button> -->

          <!-- Theme Toggle -->
          <button class="p-2 rounded-xl hover:bg-white/10 transition-colors group">
            <i class="pi pi-moon text-xl text-gray-700 dark:text-gray-300 group-hover:text-blue-500"></i>
          </button>

          <!-- User Menu -->
          <div class="relative" *ngIf="userProfile">
            <button [matMenuTriggerFor]="userMenu" 
                    class="flex items-center space-x-3 p-2 rounded-xl hover:bg-white/10 transition-colors group">
              <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center">
                <span class="text-white font-semibold text-sm">
                  {{ getUserInitials() }}
                </span>
              </div>
              <span class="hidden md:block font-medium text-gray-900 dark:text-white">
                {{ getFirstName() }}
              </span>
              <i class="pi pi-chevron-down text-sm text-gray-500 group-hover:text-gray-700 dark:group-hover:text-gray-300"></i>
            </button>

            <mat-menu #userMenu="matMenu" class="user-menu">
              <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                <p class="font-medium text-gray-900 dark:text-white">{{ getUserFullName() }}</p>
                <p class="text-sm text-gray-500 dark:text-gray-400">{{ getUserEmail() }}</p>
              </div>
              
              <button mat-menu-item routerLink="/profile" class="flex items-center space-x-3 py-3">
                <i class="pi pi-user text-gray-500"></i>
                <span>Profile Settings</span>
              </button>
              
             <!--  <button mat-menu-item class="flex items-center space-x-3 py-3">
                <i class="pi pi-cog text-gray-500"></i>
                <span>Preferences</span>
              </button>
               -->
              <!-- <button mat-menu-item class="flex items-center space-x-3 py-3">
                <i class="pi pi-question-circle text-gray-500"></i>
                <span>Help & Support</span>
              </button> -->
              
              <mat-divider></mat-divider>
              
              <button mat-menu-item (click)="logout()" class="flex items-center space-x-3 py-3 text-red-600 dark:text-red-400">
                <i class="pi pi-sign-out"></i>
                <span>Sign Out</span>
              </button>
            </mat-menu>
          </div>
        </div>
      </div>
    </header>

    <!-- Page Content -->
    <main class="flex-1 overflow-auto">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>

<!-- Mobile Bottom Navigation -->
<nav class="bottom-nav md:hidden" *ngIf="showMobileNav">
  <div class="grid grid-cols-5 gap-1">
    <a routerLink="/dashboard" 
       routerLinkActive="active"
       class="bottom-nav-item">
      <i class="pi pi-th-large text-lg"></i>
      <span class="text-xs font-medium">Home</span>
    </a>
    
    <a routerLink="/tasks" 
       routerLinkActive="active"
       class="bottom-nav-item">
      <i class="pi pi-check-circle text-lg"></i>
      <span class="text-xs font-medium">Tasks</span>
    </a>
    
    <button class="bottom-nav-item bg-gradient-primary text-white rounded-2xl mx-2 -mt-4 shadow-glow"
            routerLink="/tasks">
      <i class="pi pi-plus text-xl"></i>
    </button>
    
    <a href="#" class="bottom-nav-item">
      <i class="pi pi-chart-bar text-lg"></i>
      <span class="text-xs font-medium">Stats</span>
    </a>
    
    <a routerLink="/profile" 
       routerLinkActive="active"
       class="bottom-nav-item">
      <i class="pi pi-user text-lg"></i>
      <span class="text-xs font-medium">Profile</span>
    </a>
  </div>
</nav>

<!-- Mobile Sidebar Overlay -->
<div *ngIf="showMobileSidebar" 
     class="fixed inset-0 bg-black/50 z-50 md:hidden"
     (click)="closeMobileSidebar()">
  <aside class="sidebar-modern w-80 h-full" (click)="$event.stopPropagation()">
    <!-- Sidebar Header -->
    <div class="flex items-center justify-between p-6 border-b border-gray-700/50">
      <div class="flex items-center space-x-3">
        <div class="w-10 h-10 bg-gradient-primary rounded-xl flex items-center justify-center shadow-glow">
          <i class="pi pi-check-circle text-white text-lg"></i>
        </div>
        <div>
          <h1 class="text-xl font-bold text-white">TaskFlow</h1>
          <p class="text-xs text-gray-400">Pro Dashboard</p>
        </div>
      </div>
      <button (click)="closeMobileSidebar()" 
              class="p-2 rounded-lg hover:bg-white/10 transition-colors text-gray-400 hover:text-white">
        <i class="pi pi-times"></i>
      </button>
    </div>

    <!-- User Profile Section -->
    <div class="p-6 border-b border-gray-700/50" *ngIf="userProfile">
      <div class="flex items-center space-x-3">
        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
          <span class="text-white font-semibold text-lg">
            {{ getUserInitials() }}
          </span>
        </div>
        <div class="flex-1 min-w-0">
          <div class="font-semibold text-white truncate">{{ getFirstName() }}</div>
          <div class="text-sm text-gray-400 truncate">{{ getUserEmail() }}</div>
        </div>
      </div>
    </div>

    <!-- Navigation Menu -->
    <nav class="flex-1 px-4 py-6 space-y-2 overflow-y-auto">
      <!-- Dashboard -->
      <a routerLink="/dashboard" 
         routerLinkActive="active"
         class="sidebar-item group"
         (click)="closeMobileSidebar()">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-th-large text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3">Dashboard</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a>

      <!-- Tasks (Highlighted) -->
      <!-- <a routerLink="/tasks" 
         class="sidebar-item group bg-gradient-to-r from-red-500/20 to-pink-500/20 border border-red-500/30"
         (click)="closeMobileSidebar()">
        <div class="w-10 h-10 rounded-xl bg-red-500/20 flex items-center justify-center group-hover:bg-red-500/30 transition-colors">
          <i class="pi pi-exclamation-triangle text-lg text-red-400"></i>
        </div>
        <span class="font-medium text-red-300 ml-3">Vital Tasks</span>
        <div class="ml-auto">
          <span class="px-2 py-1 bg-red-500 text-white text-xs rounded-full">{{ getTotalTasks() }}</span>
        </div>
      </a> -->

      <!-- My Tasks -->
      <a routerLink="/tasks" 
         routerLinkActive="active"
         class="sidebar-item group"
         (click)="closeMobileSidebar()">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-check-circle text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3">Mis tareas</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a>

      <!-- Categories -->
      <!-- <a href="#" class="sidebar-item group" (click)="closeMobileSidebar()">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-tags text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3">Categories</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a> -->

      <!-- Analytics -->
      <!-- <a href="#" class="sidebar-item group" (click)="closeMobileSidebar()">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-chart-bar text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3">Analytics</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a> -->

      <!-- Divider -->
      <div class="border-t border-gray-700/50 my-6"></div>

      <!-- Settings -->
      <a routerLink="/profile" 
         routerLinkActive="active"
         class="sidebar-item group"
         (click)="closeMobileSidebar()">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-cog text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3">Settings</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a>

      <!-- Help -->
      <!-- <a href="#" class="sidebar-item group" (click)="closeMobileSidebar()">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-white/20 transition-colors">
          <i class="pi pi-question-circle text-lg text-white"></i>
        </div>
        <span class="font-medium text-white ml-3">Help</span>
        <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
          <i class="pi pi-chevron-right text-white/60"></i>
        </div>
      </a> -->
    </nav>

    <!-- Logout Button -->
    <div class="p-4 border-t border-gray-700/50">
      <button (click)="logout(); closeMobileSidebar()" 
              class="sidebar-item group w-full hover:bg-red-500/20 border border-transparent hover:border-red-500/30">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center group-hover:bg-red-500/20 transition-colors">
          <i class="pi pi-sign-out text-lg text-white group-hover:text-red-300"></i>
        </div>
        <span class="font-medium text-white group-hover:text-red-300 ml-3">Cerrar Sesión</span>
      </button>
    </div>
  </aside>
</div>